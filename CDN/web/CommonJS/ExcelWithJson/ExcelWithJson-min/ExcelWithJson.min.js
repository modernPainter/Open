"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},web={fileInfro:"",startWebWork:function(){var o=new Worker(web.fileInfro.url,{name:web.fileInfro.name});return setTimeout(function(){o.postMessage(web.fileInfro.fileobj)},200),new Promise(function(t,e){return o.onmessage=function(e){o.terminate(),o=void 0,t(e.data)}})},excelToJSON:function(e){if(e.file.files.length>0){var t=e.file.files[0].name.split(".")[1],o=e.file.files[0].size/1024;if("xls"==t||"xlsx"==t){if(!(40960<o)){var n=(new Date).getTime(),r={fileobj:e.file.files[0],url:e.url||"./ExcelWithJson/ExcelToJson.min.js",name:e.name||"newWebwork"+n};return web.fileInfro=r,web.startWebWork()}alert(">_<：导入文件不要大于40M，会解析很久的！")}else alert(">_<：导入的文件格式错啦!")}else alert(">_<：没有导入的文件!")},JsonToExcel:function(e,t){var o=[],n="object"!=(void 0===e?"undefined":_typeof(e))?JSON.parse(e):e;for(var r in n[0])o.push(r.toString());var i={fileName:t||"excel"+(new Date).getTime(),datas:[{sheetHeader:o,sheetData:n,sheetName:"sheet1"}]};new ExportJsonExcel(i).saveExcel()}};